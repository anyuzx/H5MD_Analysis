import numpy as np
import cython
cimport numpy as np

DTYPE = np.float32
ctypedef np.float32_t DTYPE_t

cdef int type_list[264][2]
type_list[0][:] = [1,33]
type_list[1][:] = [825,827]
type_list[2][:] = [1096,1098]
type_list[3][:] = [1578,1629]
type_list[4][:] = [1868,1870]
type_list[5][:] = [1893,1898]
type_list[6][:] = [1918,1942]
type_list[7][:] = [1947,1956]
type_list[8][:] = [2332,2339]
type_list[9][:] = [2379,2398]
type_list[10][:] = [2450,2451]
type_list[11][:] = [2459,2461]
type_list[12][:] = [2502,2553]
type_list[13][:] = [2562,2564]
type_list[14][:] = [2597,2598]
type_list[15][:] = [2606,2608]
type_list[16][:] = [2619,2622]
type_list[17][:] = [2647,2661]
type_list[18][:] = [2696,2809]
type_list[19][:] = [2854,2855]
type_list[20][:] = [2892,2893]
type_list[21][:] = [2918,2974]
type_list[22][:] = [2981,2983]
type_list[23][:] = [2989,3002]
type_list[24][:] = [3010,3017]
type_list[25][:] = [3054,3061]
type_list[26][:] = [3137,3140]
type_list[27][:] = [3208,3212]
type_list[28][:] = [3218,3300]
type_list[29][:] = [3307,3310]
type_list[30][:] = [3322,3392]
type_list[31][:] = [3423,3426]
type_list[32][:] = [3444,3449]
type_list[33][:] = [3472,3473]
type_list[34][:] = [3485,3558]
type_list[35][:] = [3574,3588]
type_list[36][:] = [3776,3946]
type_list[37][:] = [3952,3995]
type_list[38][:] = [4132,4136]
type_list[39][:] = [4143,4176]
type_list[40][:] = [4193,4195]
type_list[41][:] = [4269,4274]
type_list[42][:] = [4302,4391]
type_list[43][:] = [4400,4446]
type_list[44][:] = [4496,4497]
type_list[45][:] = [4508,4513]
type_list[46][:] = [5020,5021]
type_list[47][:] = [5269,5272]
type_list[48][:] = [5621,5623]
type_list[49][:] = [5719,5730]
type_list[50][:] = [5921,5927]
type_list[51][:] = [6168,6172]
type_list[52][:] = [6253,6308]
type_list[53][:] = [6319,6321]
type_list[54][:] = [6350,6357]
type_list[55][:] = [6409,6411]
type_list[56][:] = [6416,6643]
type_list[57][:] = [6649,6651]
type_list[58][:] = [6655,6657]
type_list[59][:] = [6662,6689]
type_list[60][:] = [6709,6712]
type_list[61][:] = [6724,6726]
type_list[62][:] = [6732,6739]
type_list[63][:] = [6793,6794]
type_list[64][:] = [6801,6810]
type_list[65][:] = [6828,6829]
type_list[66][:] = [6854,6856]
type_list[67][:] = [6887,6967]
type_list[68][:] = [6973,7069]
type_list[69][:] = [7092,7093]
type_list[70][:] = [7106,7110]
type_list[71][:] = [7146,7148]
type_list[72][:] = [7725,7767]
type_list[73][:] = [8278,8281]
type_list[74][:] = [8300,8301]
type_list[75][:] = [8645,8648]
type_list[76][:] = [8698,8710]
type_list[77][:] = [8726,8750]
type_list[78][:] = [8779,8783]
type_list[79][:] = [8819,8830]
type_list[80][:] = [8838,8839]
type_list[81][:] = [8859,8862]
type_list[82][:] = [8872,8873]
type_list[83][:] = [8887,8896]
type_list[84][:] = [8904,8918]
type_list[85][:] = [8923,8942]
type_list[86][:] = [8977,8986]
type_list[87][:] = [9015,9127]
type_list[88][:] = [9178,9182]
type_list[89][:] = [9184,9189]
type_list[90][:] = [9192,9285]
type_list[91][:] = [9292,9309]
type_list[92][:] = [9340,9341]
type_list[93][:] = [9356,9358]
type_list[94][:] = [9391,9397]
type_list[95][:] = [9404,9415]
type_list[96][:] = [9418,9433]
type_list[97][:] = [9442,9518]
type_list[98][:] = [9524,9525]
type_list[99][:] = [9558,9564]
type_list[100][:] = [9794,9797]
type_list[101][:] = [9958,9976]
type_list[102][:] = [9990,9995]
type_list[103][:] = [34,43]
type_list[104][:] = [45,396]
type_list[105][:] = [398,506]
type_list[106][:] = [508,751]
type_list[107][:] = [753,761]
type_list[108][:] = [763,802]
type_list[109][:] = [804,824]
type_list[110][:] = [828,905]
type_list[111][:] = [907,1076]
type_list[112][:] = [1078,1095]
type_list[113][:] = [1099,1139]
type_list[114][:] = [1141,1407]
type_list[115][:] = [1409,1492]
type_list[116][:] = [1494,1570]
type_list[117][:] = [1572,1577]
type_list[118][:] = [1630,1660]
type_list[119][:] = [1662,1867]
type_list[120][:] = [1871,1880]
type_list[121][:] = [1882,1892]
type_list[122][:] = [1899,1917]
type_list[123][:] = [1943,1946]
type_list[124][:] = [1957,2019]
type_list[125][:] = [2021,2056]
type_list[126][:] = [2058,2209]
type_list[127][:] = [2211,2312]
type_list[128][:] = [2314,2315]
type_list[129][:] = [2317,2331]
type_list[130][:] = [2340,2378]
type_list[131][:] = [2399,2449]
type_list[132][:] = [2452,2453]
type_list[133][:] = [2455,2458]
type_list[134][:] = [2462,2501]
type_list[135][:] = [2554,2561]
type_list[136][:] = [2565,2571]
type_list[137][:] = [2573,2575]
type_list[138][:] = [2577,2596]
type_list[139][:] = [2599,2605]
type_list[140][:] = [2609,2618]
type_list[141][:] = [2623,2637]
type_list[142][:] = [2639,2646]
type_list[143][:] = [2662,2695]
type_list[144][:] = [2810,2853]
type_list[145][:] = [2856,2874]
type_list[146][:] = [2876,2891]
type_list[147][:] = [2894,2917]
type_list[148][:] = [2975,2980]
type_list[149][:] = [2984,2988]
type_list[150][:] = [3003,3009]
type_list[151][:] = [3018,3026]
type_list[152][:] = [3028,3053]
type_list[153][:] = [3062,3106]
type_list[154][:] = [3108,3120]
type_list[155][:] = [3122,3136]
type_list[156][:] = [3141,3207]
type_list[157][:] = [3213,3217]
type_list[158][:] = [3301,3306]
type_list[159][:] = [3311,3321]
type_list[160][:] = [3393,3416]
type_list[161][:] = [3418,3422]
type_list[162][:] = [3427,3443]
type_list[163][:] = [3450,3471]
type_list[164][:] = [3474,3484]
type_list[165][:] = [3559,3573]
type_list[166][:] = [3589,3592]
type_list[167][:] = [3594,3630]
type_list[168][:] = [3632,3678]
type_list[169][:] = [3680,3775]
type_list[170][:] = [3947,3951]
type_list[171][:] = [3996,4006]
type_list[172][:] = [4008,4021]
type_list[173][:] = [4023,4096]
type_list[174][:] = [4098,4114]
type_list[175][:] = [4116,4131]
type_list[176][:] = [4137,4142]
type_list[177][:] = [4177,4192]
type_list[178][:] = [4196,4222]
type_list[179][:] = [4224,4232]
type_list[180][:] = [4234,4268]
type_list[181][:] = [4275,4301]
type_list[182][:] = [4392,4399]
type_list[183][:] = [4447,4495]
type_list[184][:] = [4498,4507]
type_list[185][:] = [4514,4548]
type_list[186][:] = [4550,4613]
type_list[187][:] = [4615,4710]
type_list[188][:] = [4712,4883]
type_list[189][:] = [4885,4976]
type_list[190][:] = [4978,5019]
type_list[191][:] = [5022,5031]
type_list[192][:] = [5033,5268]
type_list[193][:] = [5273,5548]
type_list[194][:] = [5550,5620]
type_list[195][:] = [5624,5718]
type_list[196][:] = [5731,5920]
type_list[197][:] = [5928,6167]
type_list[198][:] = [6173,6252]
type_list[199][:] = [6309,6318]
type_list[200][:] = [6322,6349]
type_list[201][:] = [6358,6408]
type_list[202][:] = [6412,6415]
type_list[203][:] = [6644,6648]
type_list[204][:] = [6652,6654]
type_list[205][:] = [6660,6661]
type_list[206][:] = [6690,6692]
type_list[207][:] = [6694,6708]
type_list[208][:] = [6713,6723]
type_list[209][:] = [6727,6731]
type_list[210][:] = [6740,6767]
type_list[211][:] = [6769,6792]
type_list[212][:] = [6795,6797]
type_list[213][:] = [6799,6800]
type_list[214][:] = [6811,6827]
type_list[215][:] = [6830,6853]
type_list[216][:] = [6857,6886]
type_list[217][:] = [6968,6972]
type_list[218][:] = [7070,7091]
type_list[219][:] = [7094,7097]
type_list[220][:] = [7099,7105]
type_list[221][:] = [7111,7145]
type_list[222][:] = [7149,7605]
type_list[223][:] = [7607,7724]
type_list[224][:] = [7768,7917]
type_list[225][:] = [7919,7982]
type_list[226][:] = [7984,8277]
type_list[227][:] = [8282,8299]
type_list[228][:] = [8302,8644]
type_list[229][:] = [8649,8652]
type_list[230][:] = [8654,8660]
type_list[231][:] = [8662,8697]
type_list[232][:] = [8711,8725]
type_list[233][:] = [8751,8764]
type_list[234][:] = [8766,8778]
type_list[235][:] = [8784,8818]
type_list[236][:] = [8831,8837]
type_list[237][:] = [8840,8858]
type_list[238][:] = [8863,8871]
type_list[239][:] = [8874,8886]
type_list[240][:] = [8897,8903]
type_list[241][:] = [8919,8922]
type_list[242][:] = [8943,8955]
type_list[243][:] = [8957,8976]
type_list[244][:] = [8987,9008]
type_list[245][:] = [9010,9014]
type_list[246][:] = [9128,9157]
type_list[247][:] = [9159,9177]
type_list[248][:] = [9190,9191]
type_list[249][:] = [9286,9291]
type_list[250][:] = [9310,9339]
type_list[251][:] = [9342,9355]
type_list[252][:] = [9359,9390]
type_list[253][:] = [9398,9403]
type_list[254][:] = [9416,9417]
type_list[255][:] = [9434,9441]
type_list[256][:] = [9519,9523]
type_list[257][:] = [9526,9541]
type_list[258][:] = [9543,9557]
type_list[259][:] = [9565,9588]
type_list[260][:] = [9590,9793]
type_list[261][:] = [9798,9957]
type_list[262][:] = [9977,9989]
type_list[263][:] = [9996,10000]

@cython.boundscheck(False)
@cython.wraparound(False)
def compute_type_gyration_tensor(np.ndarray[DTYPE_t, ndim=2] frame):
  cdef int N = frame.shape[0]
  cdef int dim = frame.shape[1]

  cdef int n_loop = 264

  cdef np.ndarray[DTYPE_t, ndim = 2] gyration_tensor = np.zeros((n_loop, 6), dtype=DTYPE)
  cdef int i, k
  cdef int loop_start, loop_end, loop_size
  cdef DTYPE_t xmean, ymean, zmean
  for i in xrange(n_loop):
    loop_start = type_list[i][0] - 1
    loop_end = type_list[i][1] - 1
    loop_size = type_list[i][1] - type_list[i][0] + 1
    xmean = np.mean(frame[loop_start:loop_end+1], axis=0)[0]
    ymean = np.mean(frame[loop_start:loop_end+1], axis=0)[1]
    zmean = np.mean(frame[loop_start:loop_end+1], axis=0)[2]
    for k in xrange(loop_size - 1):
      gyration_tensor[i,0] += (1.0/loop_size) * (frame[k+loop_start,0] - xmean) * (frame[k+loop_start,0] - xmean)
      gyration_tensor[i,1] += (1.0/loop_size) * (frame[k+loop_start,1] - ymean) * (frame[k+loop_start,1] - ymean)
      gyration_tensor[i,2] += (1.0/loop_size) * (frame[k+loop_start,2] - zmean) * (frame[k+loop_start,2] - zmean)
      gyration_tensor[i,3] += (1.0/loop_size) * (frame[k+loop_start,0] - xmean) * (frame[k+loop_start,1] - ymean)
      gyration_tensor[i,4] += (1.0/loop_size) * (frame[k+loop_start,0] - xmean) * (frame[k+loop_start,2] - zmean)
      gyration_tensor[i,5] += (1.0/loop_size) * (frame[k+loop_start,1] - ymean) * (frame[k+loop_start,2] - zmean)

  return gyration_tensor
